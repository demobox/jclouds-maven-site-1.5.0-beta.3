<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.3 at Jun 19, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>jclouds labs project - RAT (Release Audit Tool) results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20120619" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                jclouds labs project
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
            
                <div class="xleft">
        <span id="publishDate">Last Published: 2012-06-19</span>
                  &nbsp;| <span id="projectVersion">Version: 1.5.0-beta.3</span>
                      </div>
            <div class="xright">                    <a href="./" title="jclouds labs project">jclouds labs project</a>
              
            
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
            
                                <h5>Parent Project</h5>
                  <ul>
                  <li class="none">
                          <a href="../jclouds-project/index.html" title="jclouds Project">jclouds Project</a>
            </li>
          </ul>
                       <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="../virtualbox/index.html" title="jcloud virtualbox api">jcloud virtualbox api</a>
            </li>
                  <li class="none">
                          <a href="../vcloud-director/index.html" title="jclouds vcloud-director api">jclouds vcloud-director api</a>
            </li>
                  <li class="none">
                          <a href="../glesys/index.html" title="jclouds GleSYS core">jclouds GleSYS core</a>
            </li>
                  <li class="none">
                          <a href="../opsource-servers/index.html" title="jcloud opsource-servers api">jcloud opsource-servers api</a>
            </li>
                  <li class="none">
                          <a href="../elb/index.html" title="jcloud elb api">jcloud elb api</a>
            </li>
                  <li class="none">
                          <a href="../aws-elb/index.html" title="jclouds Amazon Elastic Load Balancer provider">jclouds Amazon Elastic Load Balancer provider</a>
            </li>
                  <li class="none">
                          <a href="../savvis-symphonyvpdc/index.html" title="jclouds savvis-vpdc vpdc">jclouds savvis-vpdc vpdc</a>
            </li>
                  <li class="none">
                          <a href="../dmtf/index.html" title="jclouds dmtf domain objects">jclouds dmtf domain objects</a>
            </li>
                  <li class="none">
                          <a href="../carrenza-vcloud-director/index.html" title="jclouds Carrenza vCloud Director provider">jclouds Carrenza vCloud Director provider</a>
            </li>
                  <li class="none">
                          <a href="../openstack-swift/index.html" title="jcloud openstack-swift api">jcloud openstack-swift api</a>
            </li>
                  <li class="none">
                          <a href="../jenkins/index.html" title="jcloud jenkins api">jcloud jenkins api</a>
            </li>
                  <li class="none">
                          <a href="../cdmi/index.html" title="jcloud cdmi api">jcloud cdmi api</a>
            </li>
                  <li class="none">
                          <a href="../openstack-glance/index.html" title="jcloud openstack-glance api">jcloud openstack-glance api</a>
            </li>
                  <li class="none">
                          <a href="../joyent-sdc/index.html" title="jcloud joyent-sdc api">jcloud joyent-sdc api</a>
            </li>
                  <li class="none">
                          <a href="../joyentcloud/index.html" title="jcloud joyentcloud api">jcloud joyentcloud api</a>
            </li>
                  <li class="none">
                          <a href="../openstack-quantum/index.html" title="jcloud openstack-quantum api">jcloud openstack-quantum api</a>
            </li>
                  <li class="none">
                          <a href="../rackspace-cloudidentity/index.html" title="jcloud rackspace cloudidentity api">jcloud rackspace cloudidentity api</a>
            </li>
                  <li class="none">
                          <a href="../rackspace-cloudservers-us/index.html" title="jclouds Rackspace Next Generation Cloud Servers provider">jclouds Rackspace Next Generation Cloud Servers provider</a>
            </li>
                  <li class="none">
                          <a href="../greenqloud-compute/index.html" title="jclouds Greenqloud compute provider">jclouds Greenqloud compute provider</a>
            </li>
                  <li class="none">
                          <a href="../greenqloud-storage/index.html" title="jclouds GreenQloud Simple Storage Service (S3) provider">jclouds GreenQloud Simple Storage Service (S3) provider</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
                          <a href="surefire-report.html" title="Surefire Report">Surefire Report</a>
            </li>
                      <li class="none">
            <strong>RAT Report</strong>
          </li>
              </ul>
        </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
            
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>RAT (Release Audit Tool) results<a name="RAT_Release_Audit_Tool_results"></a></h2><p>The following document contains the results of <a class="externalLink" href="http://incubator.apache.org/rat/apache-rat-plugin">RAT (Release Audit Tool)</a>.</p><p></p><div class="source"><pre>
*****************************************************
Summary
-------
Generated at: 2012-06-19T17:33:18-04:00
Notes: 0
Binaries: 0
Archives: 0
Standards: 10

Apache Licensed: 4
Generated Documents: 0

JavaDocs are generated and so license header is optional
Generated files do not required license headers

6 Unknown Licenses

*******************************

Unapproved licenses:

  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/BaseNodePoolComputeService.java
  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/EagerNodePoolComputeService.java
  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/resources/META-INF/services/org.jclouds.apis.ApiMetadata
  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/java/org/jclouds/nodepool/NodePoolComputeServiceTest.java
  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/resources/logback.xml
  /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/pom.xml

*******************************

Archives:

*****************************************************
  Files with Apache License headers will be marked AL
  Binary files (which do not require AL headers) will be marked B
  Compressed archives will be marked A
  Notices, licenses etc will be marked N
  AL    /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/config/NodePoolComputeServiceProperties.java
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/BaseNodePoolComputeService.java
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/EagerNodePoolComputeService.java
  AL    /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/NodePoolComputeService.java
  AL    /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/NodePoolApiMetadata.java
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/resources/META-INF/services/org.jclouds.apis.ApiMetadata
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/java/org/jclouds/nodepool/NodePoolComputeServiceTest.java
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/resources/logback.xml
 !????? /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/pom.xml
  AL    /scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/pom.xml
 
 *****************************************************
 Printing headers for files without AL header...
 
 
 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/BaseNodePoolComputeService.java
 =======================================================================
package org.jclouds.nodepool.internal;

import static com.google.common.base.Preconditions.checkState;
import static com.google.common.collect.Iterables.filter;
import static com.google.common.collect.Iterables.find;

import java.util.Map;
import java.util.NoSuchElementException;
import java.util.Set;
import java.util.Map.Entry;
import java.util.concurrent.atomic.AtomicBoolean;

import org.jclouds.compute.ComputeService;
import org.jclouds.compute.ComputeServiceContext;
import org.jclouds.compute.RunNodesException;
import org.jclouds.compute.RunScriptOnNodesException;
import org.jclouds.compute.domain.ComputeMetadata;
import org.jclouds.compute.domain.ExecResponse;
import org.jclouds.compute.domain.Hardware;
import org.jclouds.compute.domain.Image;
import org.jclouds.compute.domain.NodeMetadata;
import org.jclouds.compute.domain.NodeMetadataBuilder;
import org.jclouds.compute.domain.Template;
import org.jclouds.compute.domain.TemplateBuilder;
import org.jclouds.compute.extensions.ImageExtension;
import org.jclouds.compute.options.RunScriptOptions;
import org.jclouds.compute.options.TemplateOptions;
import org.jclouds.domain.Location;
import org.jclouds.nodepool.NodePoolComputeService;
import org.jclouds.scriptbuilder.domain.Statement;

import com.google.common.base.Function;
import com.google.common.base.Optional;
import com.google.common.base.Predicate;
import com.google.common.base.Predicates;
import com.google.common.collect.FluentIterable;
import com.google.common.collect.HashMultimap;
import com.google.common.collect.ImmutableSet;
import com.google.common.collect.Maps;
import com.google.common.collect.Multimap;
import com.google.common.collect.Sets;
import com.google.common.util.concurrent.ListenableFuture;

/**
 * A base class for {@link NodePoolComputeService}, takes care of keeping (not changing assignments)
 * and of everything that does not change the pool.
 * 
 * @author David Alves
 * 
 */

 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/java/org/jclouds/nodepool/internal/EagerNodePoolComputeService.java
 =======================================================================
package org.jclouds.nodepool.internal;

import static com.google.common.base.Preconditions.checkState;
import static com.google.common.collect.Iterables.removeIf;
import static com.google.common.collect.Iterables.transform;
import static org.jclouds.nodepool.config.NodePoolComputeServiceProperties.BACKING_GROUP_PROPERTY;
import static org.jclouds.nodepool.config.NodePoolComputeServiceProperties.BACKING_TEMPLATE_PROPERTY;
import static org.jclouds.nodepool.config.NodePoolComputeServiceProperties.MAX_SIZE_PROPERTY;
import static org.jclouds.nodepool.config.NodePoolComputeServiceProperties.MIN_SIZE_PROPERTY;
import static org.jclouds.nodepool.config.NodePoolComputeServiceProperties.REMOVE_DESTROYED_PROPERTY;

import java.util.Collections;
import java.util.Iterator;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

import javax.annotation.Nullable;
import javax.annotation.Resource;
import javax.inject.Inject;
import javax.inject.Named;

import org.jclouds.Constants;
import org.jclouds.compute.ComputeServiceContext;
import org.jclouds.compute.RunNodesException;
import org.jclouds.compute.domain.NodeMetadata;
import org.jclouds.compute.domain.NodeMetadataBuilder;
import org.jclouds.compute.domain.Template;
import org.jclouds.compute.domain.NodeMetadata.Status;
import org.jclouds.compute.predicates.NodePredicates;
import org.jclouds.compute.reference.ComputeServiceConstants;
import org.jclouds.concurrent.Futures;
import org.jclouds.logging.Logger;
import org.jclouds.nodepool.NodePoolComputeService;

import com.google.common.base.Function;
import com.google.common.base.Predicate;
import com.google.common.collect.ImmutableMap;
import com.google.common.collect.Sets;
import com.google.common.util.concurrent.ListenableFuture;

/**
 * An eager {@link NodePoolComputeService}. Eagerly builds and maintains a pool of nodes. It's only
 * &quot;started&quot; after min nodes are allocated and available.
 * 
 * @author David Alves

 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/main/resources/META-INF/services/org.jclouds.apis.ApiMetadata
 =======================================================================
org.jclouds.nodepool.NodePoolApiMetadata

 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/java/org/jclouds/nodepool/NodePoolComputeServiceTest.java
 =======================================================================
package org.jclouds.nodepool;

import static org.testng.Assert.assertEquals;

import java.io.IOException;
import java.util.concurrent.ExecutionException;

import org.jclouds.ContextBuilder;
import org.jclouds.compute.ComputeServiceContext;
import org.jclouds.compute.RunNodesException;
import org.jclouds.compute.predicates.NodePredicates;
import org.jclouds.nodepool.internal.EagerNodePoolComputeService;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import com.google.common.util.concurrent.ListenableFuture;

@Test(groups = &quot;unit&quot;, testName = &quot;NodePoolComputeServiceTest&quot;)
public class NodePoolComputeServiceTest {

   private EagerNodePoolComputeService pooledComputeService;

   @BeforeClass
   public void setUp() {
      ComputeServiceContext stubCtx = ContextBuilder.newBuilder(&quot;stub&quot;).buildView(ComputeServiceContext.class);
      this.pooledComputeService = new EagerNodePoolComputeService(stubCtx, &quot;pool&quot;, 10, 5, true, stubCtx
               .getComputeService().templateBuilder().build(), stubCtx.utils().getUserExecutor());
   }

   public void testStartPool() throws InterruptedException, ExecutionException {
      ListenableFuture&lt;Void&gt; future = this.pooledComputeService.startPool();
      future.get();
      assertEquals(pooledComputeService.ready(), 5);
      assertEquals(pooledComputeService.size(), 5);
      assertEquals(pooledComputeService.maxSize(), 10);
   }

   @Test(dependsOnMethods = &quot;testStartPool&quot;, groups = { &quot;unit&quot;, &quot;poolStarted&quot; })
   public void testAllocateMinNodes() throws RunNodesException {
      this.pooledComputeService.createNodesInGroup(&quot;1&quot;, 5);
      // this pool is not supposed to add nodes past min until we request them
      assertEquals(pooledComputeService.ready(), 0);
      assertEquals(pooledComputeService.size(), 5);
   }

   @Test(dependsOnMethods = &quot;testAllocateMinNodes&quot;, groups = { &quot;unit&quot;, &quot;poolStarted&quot; })
   public void testAllocateUpToMaxNodes() throws RunNodesException {
      this.pooledComputeService.createNodesInGroup(&quot;2&quot;, 5);
      assertEquals(pooledComputeService.ready(), 0);
      assertEquals(pooledComputeService.size(), 10);

 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/src/test/resources/logback.xml
 =======================================================================
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;configuration scan=&quot;false&quot;&gt;
  &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
    &lt;file&gt;target/test-data/jclouds.log&lt;/file&gt;

    &lt;encoder&gt;
      &lt;Pattern&gt;%d %-5p [%c] [%thread] %m%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;

  &lt;appender name=&quot;WIREFILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
    &lt;file&gt;target/test-data/jclouds-wire.log&lt;/file&gt;

    &lt;encoder&gt;
      &lt;Pattern&gt;%d %-5p [%c] [%thread] %m%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;

  &lt;appender name=&quot;COMPUTEFILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
    &lt;file&gt;target/test-data/jclouds-compute.log&lt;/file&gt;

    &lt;encoder&gt;
      &lt;Pattern&gt;%d %-5p [%c] [%thread] %m%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;

  &lt;appender name=&quot;SSHFILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
    &lt;file&gt;target/test-data/jclouds-ssh.log&lt;/file&gt;

    &lt;encoder&gt;
      &lt;Pattern&gt;%d %-5p [%c] [%thread] %m%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;

  &lt;appender name=&quot;CONSOLE&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
    &lt;encoder&gt;
      &lt;Pattern&gt;%-4r [%thread] %-5level - %msg%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
  &lt;/appender&gt;

  &lt;root&gt;
    &lt;level value=&quot;DEBUG&quot; /&gt;
    &lt;appender-ref ref=&quot;CONSOLE&quot; /&gt;
  &lt;/root&gt;

  &lt;logger name=&quot;org.jclouds&quot;&gt;
    &lt;level value=&quot;DEBUG&quot; /&gt;
    &lt;appender-ref ref=&quot;FILE&quot; /&gt;
  &lt;/logger&gt;


 =======================================================================
 ==/scratch/hudson/workspace/jclouds-maven-site-1.5.0-beta.3/labs/nodepool/pom.xml
 =======================================================================
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;project
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;
  xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;artifactId&gt;jclouds-project&lt;/artifactId&gt;
    &lt;groupId&gt;org.jclouds&lt;/groupId&gt;
    &lt;version&gt;1.5.0-SNAPSHOT&lt;/version&gt;
    &lt;relativePath&gt;../../project/pom.xml&lt;/relativePath&gt;
  &lt;/parent&gt;
  &lt;groupId&gt;org.jclouds.labs&lt;/groupId&gt;
  &lt;artifactId&gt;nodepool&lt;/artifactId&gt;
  &lt;name&gt;jclouds nodepool&lt;/name&gt;
  &lt;packaging&gt;bundle&lt;/packaging&gt;
  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;jsch.version&gt;0.1.46&lt;/jsch.version&gt;
    &lt;test.aws-ec2.identity&gt;${test.aws.identity}&lt;/test.aws-ec2.identity&gt;
    &lt;test.aws-ec2.credential&gt;${test.aws.credential}&lt;/test.aws-ec2.credential&gt;
    &lt;jclouds.osgi.export&gt;org.jclouds.nodepool*;version=&quot;${project.version}&quot;&lt;/jclouds.osgi.export&gt;
    &lt;jclouds.osgi.import&gt;org.jclouds*;version=&quot;${project.version}&quot;,*&lt;/jclouds.osgi.import&gt;
  &lt;/properties&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.jclouds&lt;/groupId&gt;
      &lt;artifactId&gt;jclouds-compute&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.jclouds&lt;/groupId&gt;
      &lt;artifactId&gt;jclouds-core&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
      &lt;type&gt;test-jar&lt;/type&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.jclouds&lt;/groupId&gt;
      &lt;artifactId&gt;jclouds-compute&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
      &lt;type&gt;test-jar&lt;/type&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
      &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
</pre></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2009-2012
                        <a href="http://www.jclouds.org/">jclouds</a>.
            All Rights Reserved.      
            
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
